{% extends "base.html" %}

{% block titill %} Home {% endblock %}

{% block content %}
    

<div class="ui grid">
    
    {% for post in posts%}
    <div class="one collumn row">
        <div class="post-container">
        <div class="ui card">
            <div class="content">
              <div class="right floated meta">14h</div>
              {%if post.user.profile_picture == "n/a" %}
              <img class="ui avatar image" src="{{ url_for('static', filename='img/default_profile_pic.jpg') }}"> {{post.user.username}}
              {% else %}
              <img class="ui avatar image" src="{{ url_for('static', filename='profile_data/'+post.user.id|string() + '_' + post.user.username+'/'+ post.user.profile_picture) }}"> {{post.user.username}}
              {% endif %}  
            </div>
            <div class="image">
                <img class="ui medium centered image" id='{{post.id}}' >             
                <span class="left floated">
                    <i id="{{post.id|string + '_leftIcon'}}" class="angle large left link icon"></i>
                </span>
                <span class="right floated">
                    <i id="{{post.id|string + '_rightIcon'}}" class="angle large right link icon"></i>
                </span>
            </div>
 
            <div class="content">

              <span class="right floated">
                <i class="heart outline like icon"></i>
                {{post.likes}} likes
              </span>
          </div>
        {% set image_list = []%}
        {% for item in clothing%}
            
            {%if item.id == post.hat %}
                {{image_list.append(item.image_link)  or "" }}
            {% endif %}

            {%if item.id == post.shirt %}
                {{image_list.append(item.image_link) or ""}}
            {% endif %}

            {%if item.id == post.jacket %}
                {{image_list.append(item.image_link) or ""}}
            {% endif %}

            {%if item.id == post.gloves %}
                {{image_list.append(item.image_link) or ""}}
            {% endif %}

            {%if item.id == post.pants %}
                {{image_list.append(item.image_link) or ""}}
            {% endif %}

            {%if item.id == post.shorts %}
                {{image_list.append(item.image_link)or ""}}
            {% endif %}

            {%if item.id == post.shoes %}
            {{image_list.append(item.image_link) or ""}}
            {% endif %}

            {%if item.id == post.socks %}
                {{image_list.append(item.image_link ) or ""}}
            {% endif %}
            
        {% endfor %}
       <script > 
            
            var img_list = {{image_list| tojson}};
            
            var id = {{post.id| tojson}};
            var step = 0;

            var imgElement = document.getElementById(id);
            imgElement.src = "static/clothes_images/"+img_list[step];

            backArrow = document.getElementById(id.toString()+"_leftIcon");
            forwardArrow = document.getElementById(id.toString()+"_rightIcon");
            
            leftArrowOn = "angle large left link icon"
            rightArrowOn = "angle large right link icon"
            arrowoff = "hidden"

            if(img_list.length == 1){
                backArrow.className = "hidden";
                forwardArrow.className = "hidden"
            }
            onUpdate()
            function onUpdate(){
                if(step<=1){
                    backArrow.className = arrowoff;
                }
                if(step>0){
                    backArrow.className = leftArrowOn;
                }
                if(step==img_list.length-1){
                    forwardArrow.className = arrowoff;
                }
                if(step<img_list.length-1 && img_list.length > 1){
                    forwardArrow.className = rightArrowOn;
                    
                }
                console.log(step);
                console.log(img_list.length-1)
            }
            function changeImageMinus() {
                
                if(step==0){
                    return
                } 
                step--
                imgElement.src = "static/clothes_images/"+img_list[step];

            }
            function changeImagePlus() {
                
                if(step==img_list.length-1) return
                step++
                imgElement.src = "static/clothes_images/"+img_list[step];
            }
            forwardArrow.addEventListener("click", function() {
                changeImagePlus();
                onUpdate()

              });
            backArrow.addEventListener("click", function() {
                changeImageMinus();
                onUpdate()
                
              });
            
            
        </script>

    </div>
    </div>
    {% endfor %}

</div>

{% endblock content %}


